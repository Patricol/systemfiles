#!/usr/bin/env bash

for_x() {
	xdotool type "$(xclip -o -selection clipboard)"
}

for_wayland() {
	sudo echo "Authenticating now so there can be a sleep between the password prompt and action"
	sleep 2s
	sudo ydotool type "$(wl-paste)"
}

main() {
	argue_options=("x,in_xorg,noarg" "w,in_wayland,noarg" "s,skip_sleep,noarg")
	source "$(which argue)"
	if [[ -z "${skip_sleep}" ]]; then
		echo sleeping
		sleep 1s
	fi
	if [[ -n "${in_xorg}" ]]; then
		for_x
	elif [[ -n "${in_wayland}" ]]; then
		for_wayland
	else
		echo "Choose Wayland or X" >&2
		exit 1
	fi
}

main $@
